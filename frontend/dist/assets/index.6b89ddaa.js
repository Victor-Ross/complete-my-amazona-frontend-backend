var le=Object.defineProperty,oe=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var Z=(r,a,i)=>a in r?le(r,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[a]=i,f=(r,a)=>{for(var i in a||(a={}))ue.call(a,i)&&Z(r,i,a[i]);if(Y)for(var i of Y(a))he.call(a,i)&&Z(r,i,a[i]);return r},y=(r,a)=>oe(r,de(a));import{a as me,r as g,u as E,j as e,F as d,b as t,I as pe,B as D,T as ge,N as z,C as G,c as M,L as w,d as K,e as H,t as F,f as I,S as fe,A as ye,W as T,R as L,g as u,h as S,i as ee,k as J,l as V,m as ve,P as be,n as Ne,o as re,p as Ie,q as $,s as Se,v as Ce,w as Pe,x as we,y as xe}from"./vendor.b48f4ed6.js";const _e=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(n){if(n.ep)return;n.ep=!0;const c=i(n);fetch(n.href,c)}};_e();const B=me.create({baseURL:"https://my-amazona-victor.herokuapp.com"}),te=g.exports.createContext({});function Re({children:r}){const a={userInfo:localStorage.getItem("userInfo")?JSON.parse(String(localStorage.getItem("userInfo"))):null,cart:{cartItems:localStorage.getItem("cartItems")?JSON.parse(String(localStorage.getItem("cartItems"))):[],shippingAddress:localStorage.getItem("shippingAddress")?JSON.parse(String(localStorage.getItem("shippingAddress"))):null,paymentMethod:localStorage.getItem("paymentMethod")?String(localStorage.getItem("paymentMethod")):""}},i=E(),[s,n]=g.exports.useReducer(c,a);function c(o,v){switch(v.type){case"cart_add_item":{const m=v.item,p=o.cart.cartItems.find(P=>P.id===m.id),N=p?o.cart.cartItems.map(P=>P.id===p.id?m:P):[...o.cart.cartItems,m];return localStorage.setItem("cartItems",JSON.stringify(N)),y(f({},o),{cart:y(f({},o.cart),{cartItems:N})})}case"cart_remove_item":{const m=o.cart.cartItems.filter(p=>p.id!==v.item.id);return localStorage.setItem("cartItems",JSON.stringify(m)),y(f({},o),{cart:y(f({},o.cart),{cartItems:m})})}case"cart_clear":return y(f({},o),{cart:y(f({},o.cart),{cartItems:[]})});case"user_signin":return y(f({},o),{userInfo:v.user});case"user_signout":return y(f({},o),{userInfo:null,cart:{cartItems:[],shippingAddress:{},paymentMethod:""}});case"save_shipping_address":return y(f({},o),{cart:y(f({},o.cart),{shippingAddress:v.shippingAddress})});case"save_payment_method":return y(f({},o),{cart:y(f({},o.cart),{paymentMethod:v.paymentMethod})});default:return o}}async function l(o,v){if((await B.get(`/api/products/${o.id}`)).data.countInStock<v){window.alert("Sorry, Product is out of stock");return}n({type:"cart_add_item",item:y(f({},o),{quantity:v})})}async function x(o){const v=s.cart.cartItems.find(P=>P.id===o.id),m=v?v.quantity+1:1;if((await B.get(`/api/products/${o.id}`)).data.countInStock<m){window.alert("Sorry, Product is out of stock");return}n({type:"cart_add_item",item:y(f({},o),{quantity:m})})}async function h(o){n({type:"cart_remove_item",item:o})}function R(){i("/signin?redirect=/shipping")}const C=()=>{n({type:"user_signout"}),localStorage.removeItem("userInfo"),localStorage.removeItem("shippingAddress"),localStorage.removeItem("paymentMethod"),window.location.href="/signin"};function _(){const o=P=>Math.round(P*100+Number.EPSILON)/100,v=o(s.cart.cartItems.reduce((P,b)=>P+b.price,0)),m=v>100?o(0):o(10),p=o(.15*v),N=v+m+p;return{itemsPrice:v,shippingPrice:m,taxPrice:p,totalPrice:N}}return e(te.Provider,{value:{state:s,finishedShopping:_,dispatch:n,updateCartHandler:l,removeProductHandler:h,checkoutHandler:R,addProductFromHomeScreenCartHandler:x,signOutHandler:C},children:r})}function k(){return g.exports.useContext(te)}function Le(){return e("footer",{className:"text-center",children:e("div",{children:"All rights reserved"})})}const O=r=>r.response&&r.response.data.message?r.response.data.message:r.message;function De(){const r=E(),[a,i]=g.exports.useState("");return e(d,{className:"d-flex me-auto",onSubmit:n=>{n.preventDefault(),r(a?`search/?query=${a}`:"/search")},children:t(pe,{children:[e(d.Control,{type:"text",name:"q",id:"q",onChange:n=>i(n.target.value),placeholder:"Search products...","aria-label":"Search Products","aria-describedby":"button-search"}),e(D,{type:"submit",id:"button-search",className:"buttonsDefaultColors",children:e("i",{className:"fas fa-search"})})]})})}function Be(){const{state:r,signOutHandler:a}=k(),{cart:i,userInfo:s}=r,[n,c]=g.exports.useState(!1),[l,x]=g.exports.useState([]);return g.exports.useEffect(()=>{const h=new AbortController;return(async()=>{try{const{data:C}=await B.get("/api/products/categories");x(C)}catch(C){F.error(O(C))}})(),()=>{h.abort()}},[]),t("div",{className:n?"d-flex flex-column activeContainer":"d-flex flex-column",children:[e(ge,{position:"bottom-center",limit:1}),e("header",{children:e(z,{bg:"dark",variant:"dark",expand:"lg",children:t(G,{children:[e(D,{variant:"dark",onClick:()=>c(!n),children:e("i",{className:"fas fa-bars"})}),e(M.Link,{as:w,to:"/",children:e(z.Brand,{children:"amazona"})}),e(z.Toggle,{"aria-controls":"basic-navbar-nav"}),t(z.Collapse,{id:"basic-navbar-nav",children:[e(De,{}),t(M,{className:"me-auto w-100 justify-content-end",children:[t(w,{to:"/cart",className:"nav-link",children:["Cart",i.cartItems.length>0&&e(K,{pill:!0,bg:"danger",children:i.cartItems.reduce((h,R)=>h+R.quantity,0)})]}),s?t(H,{title:s.name,id:"basic-nav-dropdown",children:[e(H.Item,{as:w,to:"/profile",children:"User Profile"}),e(H.Item,{as:w,to:"/orderhistory",children:"Order History"}),e(H.Divider,{}),e(w,{to:"#signout",className:"dropdown-item",onClick:a,children:"Sign Out"})]}):e(w,{className:"nav-link",to:"/signin",children:"Sign In"}),s&&s.isAdmin&&t(H,{title:"admin",id:"admin-nav-dropdown",children:[e(H.Item,{as:w,to:"/admin/dashboard",children:"Dashboard"}),e(H.Item,{as:w,to:"/admin/productlist",children:"Products"}),e(H.Item,{as:w,to:"/admin/orderlist",children:"Orders"}),e(H.Item,{as:w,to:"/admin/userlist",children:"Users"})]})]})]})]})})}),e("div",{className:n?"activeNav sideNavbar d-flex justify-content-between flex-wrap flex-column":"sideNavbar d-flex justify-content-between flex-wrap flex-column",children:t(M,{className:"flex-column text-white w-100 p-2",children:[e(M.Item,{children:e("strong",{children:"Categories"})}),l.map(h=>e(M.Item,{children:e(M.Link,{as:w,to:`/search?category=${h.category}`,onClick:()=>c(!1),children:h.category})},h.category))]})})]})}function j({rating:r,numReviews:a,caption:i}){return t("div",{className:"rating",children:[e("span",{children:e("i",{className:r>=1?"fas fa-star":r>=.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=2?"fas fa-star":r>=1.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=3?"fas fa-star":r>=2.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=4?"fas fa-star":r>=3.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=5?"fas fa-star":r>=4.5?"fa fa-star-half-alt":"far fa-star"})}),i?e("span",{children:i}):e("span",{children:" "+a+" reviews"})]})}function ae({product:r}){const{addProductFromHomeScreenCartHandler:a}=k();return t(I,{className:"productItem",children:[e(w,{to:`/product/${r.slug}`,children:e("img",{src:r.image,className:"card-img-top",alt:r.name})}),t(I.Body,{children:[e(w,{to:`/product/${r.slug}`,children:e(I.Title,{color:"secondary",children:r.name})}),e(j,{rating:r.rating,numReviews:r.numReviews}),e(I.Text,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r.price)}),r.countInStock===0?e(D,{variant:"secondary",disabled:!0,children:"Out of Stock"}):e(D,{className:"buttonsDefaultColors",onClick:()=>a(r),children:"Add to Cart"})]})]})}function U(){return e(fe,{animation:"border",role:"status",children:e("span",{className:"visually-hidden",children:"Carregando..."})})}function A({variant:r,children:a}){return e(ye,{variant:r||"info",children:a})}function ke(r,a){switch(a.type){case"request":return y(f({},r),{isLoading:!0});case"success":return y(f({},r),{products:a.products,isLoading:!1});case"fail":return y(f({},r),{isLoading:!1,error:a.error});default:return r}}function $e(){const[{products:r,isLoading:a,error:i},s]=g.exports.useReducer(ke,{products:[],isLoading:!1,error:""});return g.exports.useEffect(()=>{const n=new AbortController;return(async()=>{s({type:"request"});try{const l=await B.get("/api/products");s({type:"success",products:l.data})}catch(l){s({type:"fail",error:l.message})}})(),()=>n.abort()},[]),t("div",{className:"container",children:[e(T,{children:e("title",{children:"Amazona"})}),e("h1",{children:"Featured products"}),e("div",{className:"products",children:a?e(U,{}):i?e(A,{variant:"danger",children:i}):e(L,{children:r.map(n=>e(u,{sm:6,md:4,lg:3,className:"mb-3",children:e(ae,{product:n})},n.slug))})})]})}function qe(){const{state:r,updateCartHandler:a,removeProductHandler:i,checkoutHandler:s}=k(),{cart:{cartItems:n}}=r;return t("div",{children:[e(T,{children:e("title",{children:"Shopping Cart"})}),e("h1",{children:"Shopping Cart"}),t(L,{children:[e(u,{md:8,children:n.length===0?t(A,{children:["Cart is empty. ",e(w,{to:"/",children:"Go Shopping"})]}):e(S,{children:n.map(c=>e(S.Item,{children:t(L,{className:"align-items-center",children:[t(u,{md:"4",className:"d-flex align-items-center justify-content-around",children:[e("img",{src:c.image,alt:c.name,style:{height:"80px"},className:"img-fluid border border-dark p-1"})," ",e(w,{to:`/product/${c.slug}`,children:c.name})]}),t(u,{md:"3",children:[e(D,{variant:"light",onClick:()=>a(c,c.quantity-1),disabled:c.quantity===1,children:e("i",{className:"fas fa-minus-circle"})})," ",e("span",{children:c.quantity})," ",e(D,{variant:"light",onClick:()=>a(c,c.quantity+1),disabled:c.quantity===c.countInStock,children:e("i",{className:"fas fa-plus-circle"})})]}),e(u,{md:"3",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c.price)}),e(u,{md:"2",children:e(D,{variant:"light",children:e("i",{className:"fas fa-trash",onClick:()=>i(c)})})})]})},c.id))})}),e(u,{md:4,children:e(I,{children:e(I.Body,{children:t(S,{variant:"flush",children:[e(S.Item,{children:t("h3",{children:["Subtotal (",n.reduce((c,l)=>c+l.quantity,0)," ","items):",e("br",{}),e("br",{}),new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n.reduce((c,l)=>c+l.price*l.quantity,0))]})}),e(S.Item,{children:e("div",{className:"d-grid",children:e(D,{className:"buttonsDefaultColors",type:"button",onClick:s,disabled:n.length===0,children:"Proceed to Checkout"})})})]})})})})]})]})}function Oe(r,a){switch(a.type){case"request":return y(f({},r),{isLoading:!0});case"success":return y(f({},r),{product:a.product,isLoading:!1});case"fail":return y(f({},r),{isLoading:!1,error:a.error});default:return r}}function Ee(){const r=E(),[{product:a,isLoading:i,error:s},n]=g.exports.useReducer(Oe,{product:{},isLoading:!1,error:""}),{slug:c}=ee();g.exports.useEffect(()=>{(async()=>{n({type:"request"});try{const _=await B.get(`/api/products/slug/${c}`);n({type:"success",product:_.data})}catch(_){n({type:"fail",error:O(_)})}})()},[c]);const{state:l,dispatch:x}=k(),{cart:h}=l;async function R(){const C=h.cartItems.find(v=>v.id===a.id),_=C?C.quantity+1:1,{data:o}=await B.get(`/api/products/${a.id}`);if(o.countInStock<_){window.alert("Sorry. Product is out of stock");return}x({type:"cart_add_item",item:y(f({},a),{quantity:_})}),r("/cart")}return e(J,{children:i?e(U,{}):s?e(A,{variant:"danger",children:s}):t(L,{children:[e(u,{md:6,children:e("img",{className:"imgLarge",src:a.image,alt:a.name})}),e(u,{md:3,children:t(S,{variant:"flush",children:[t(S.Item,{className:"my-3",children:[e(T,{children:e("title",{children:a.name})}),e("h1",{children:a.name})]}),e(S.Item,{children:e(j,{rating:a.rating,numReviews:a.numReviews})}),t(S.Item,{children:["Price :",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.price)]}),t(S.Item,{children:["Description:",e("p",{children:a.description})]})]})}),e(u,{className:"mt-5",md:3,children:e(I,{children:e(I.Body,{children:t(S,{variant:"flush",children:[e(S.Item,{children:t(L,{children:[e(u,{children:"Price:"}),e(u,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.price)})]})}),e(S.Item,{children:t(L,{children:[e(u,{children:"Status:"}),e(u,{children:a.countInStock>0?e(K,{bg:"success",children:"In Stock"}):e(K,{bg:"danger",children:"Unavailable"})})]})}),a.countInStock>0&&e(S.Item,{children:e("div",{className:"d-grid",children:e(D,{style:{backgroundColor:"#ffc000",color:"#000"},variant:"primary",onClick:R,children:"Add to Cart"})})})]})})})})]})})}function Te(){const r=E(),{search:a}=V(),i=new URLSearchParams(a).get("redirect"),s=i||"/",[n,c]=g.exports.useState(),[l,x]=g.exports.useState(),{state:h,dispatch:R}=k(),{userInfo:C}=h;async function _(o){o.preventDefault();try{const{data:v}=await B.post("/api/users/signin",{email:n,password:l});R({type:"user_signin",user:v}),localStorage.setItem("userInfo",JSON.stringify(v)),r(s||"/")}catch(v){F.error(O(v))}}return g.exports.useEffect(()=>{C&&r(s)},[r,s,C]),t(G,{className:"smallContainer",children:[e(T,{children:e("title",{children:"Sign In"})}),e("h1",{className:"my-3",children:"Sign In"}),t(d,{onSubmit:_,children:[t(d.Group,{className:"mb-3",controlId:"email",children:[e(d.Label,{children:"Email"}),e(d.Control,{type:"email",onChange:o=>c(o.target.value),required:!0})]}),t(d.Group,{className:"mb-3",controlId:"password",children:[e(d.Label,{children:"Password"}),e(d.Control,{type:"password",onChange:o=>x(o.target.value),required:!0})]}),e("div",{className:"mb-3",children:e(D,{className:"buttonsDefaultColors",type:"submit",children:"Sign In"})}),t("div",{children:["New customer?"," ",e(w,{to:`/signup?redirect=${s}`,children:"Create your account"})]})]})]})}function Ae(){const r=E(),{search:a}=V(),i=new URLSearchParams(a).get("redirect"),s=i||"/",[n,c]=g.exports.useState(),[l,x]=g.exports.useState(),[h,R]=g.exports.useState(),[C,_]=g.exports.useState(),{state:o,dispatch:v}=k(),{userInfo:m}=o;async function p(N){if(N.preventDefault(),h!==C){F.error("Passwords do not match");return}try{const{data:P}=await B.post("/api/users/signup",{name:n,email:l,password:h});v({type:"user_signin",user:P}),localStorage.setItem("userInfo",JSON.stringify(P)),r(s||"/")}catch(P){F.error(O(P))}}return g.exports.useEffect(()=>{m&&r(s)},[r,s,m]),t(G,{className:"smallContainer",children:[e(T,{children:e("title",{children:"Sign Up"})}),e("h1",{className:"my-3",children:"Sign Up"}),t(d,{onSubmit:p,children:[t(d.Group,{children:[e(d.Label,{children:"Name"}),e(d.Control,{onChange:N=>c(N.target.value),required:!0})]}),t(d.Group,{className:"mb-3",controlId:"email",children:[e(d.Label,{children:"Email"}),e(d.Control,{type:"email",onChange:N=>x(N.target.value),required:!0})]}),t(d.Group,{className:"mb-3",controlId:"password",children:[e(d.Label,{children:"Password"}),e(d.Control,{type:"password",onChange:N=>R(N.target.value),required:!0})]}),t(d.Group,{className:"mb-3",controlId:"confirmPassword",children:[e(d.Label,{children:"Confirm Password"}),e(d.Control,{type:"password",onChange:N=>_(N.target.value),required:!0})]}),e("div",{className:"mb-3",children:e(D,{className:"buttonsDefaultColors",type:"submit",children:"Sign Up"})}),t("div",{children:["Already have an account?"," ",e(w,{to:`/signin?redirect=${s}`,children:"Sign-In"})]})]})]})}function W({step1:r,step2:a,step3:i,step4:s}){return t(L,{className:"checkoutSteps",children:[e(u,{className:r?"active":"",children:"Sign-In"}),e(u,{className:a?"active":"",children:"Shipping"}),e(u,{className:i?"active":"",children:"Payment"}),e(u,{className:s?"active":"",children:"Place Order"})]})}function Fe(){const r=E(),{state:a,dispatch:i}=k(),{shippingAddress:s}=a.cart,[n,c]=g.exports.useState((s==null?void 0:s.fullName)||""),[l,x]=g.exports.useState((s==null?void 0:s.address)||""),[h,R]=g.exports.useState((s==null?void 0:s.city)||""),[C,_]=g.exports.useState((s==null?void 0:s.postalCode)||""),[o,v]=g.exports.useState((s==null?void 0:s.country)||"");return g.exports.useEffect(()=>{a.userInfo||r("/signin?redirect=/shipping")},[a.userInfo,r]),t(J,{children:[e(W,{step1:!0,step2:!0}),t("div",{className:"d-flex justify-content-center",children:[e(T,{children:e("title",{children:"Shipping Address"})}),t("div",{className:"w-50",children:[e("h1",{className:"my-3",children:"Shipping Address"}),t(d,{onSubmit:p=>{p.preventDefault();const N={fullName:n,address:l,city:h,postalCode:C,country:o};i({type:"save_shipping_address",shippingAddress:N}),localStorage.setItem("shippingAddress",JSON.stringify(N)),r("/payment")},children:[t(d.Group,{className:"mb-3",children:[e(d.Label,{children:"Full Name"}),e(d.Control,{value:n,onChange:p=>c(p.target.value),required:!0})]}),t(d.Group,{className:"mb-3",children:[e(d.Label,{children:"Address"}),e(d.Control,{value:l,onChange:p=>x(p.target.value),required:!0})]}),t(d.Group,{className:"mb-3",children:[e(d.Label,{children:"City"}),e(d.Control,{value:h,onChange:p=>R(p.target.value),required:!0})]}),t(d.Group,{className:"mb-3",children:[e(d.Label,{children:"Postal Code"}),e(d.Control,{value:C,onChange:p=>_(p.target.value),required:!0})]}),t(d.Group,{className:"mb-3",children:[e(d.Label,{children:"Country"}),e(d.Control,{value:o,onChange:p=>v(p.target.value),required:!0})]}),e(d.Group,{className:"mb-3",children:e(D,{className:"buttonsDefaultColors",type:"submit",children:"Continue"})})]})]})]})]})}function He(){const r=E(),{state:a,dispatch:i}=k(),{cart:{shippingAddress:s,paymentMethod:n}}=a,[c,l]=g.exports.useState(n||"PayPal"),x=h=>{h.preventDefault(),i({type:"save_payment_method",paymentMethod:c}),localStorage.setItem("paymentMethod",c),r("/placeorder")};return g.exports.useEffect(()=>{s!=null&&s.address||r("/shipping")},[s,r]),t(J,{children:[e(W,{step1:!0,step2:!0,step3:!0}),t("div",{children:[e(T,{children:e("title",{children:"Payment Method"})}),t(G,{className:"w-50 text-left",children:[e("h1",{className:"my-3",children:"Payment Method"}),t(d,{onSubmit:x,children:[e("div",{style:{fontSize:"1.2rem"},className:"d-block mb-3",children:e(d.Check,{type:"radio",id:"PayPal",label:"PayPal",value:"PayPal",checked:c==="PayPal",onChange:h=>l(h.target.value)})}),e("div",{style:{fontSize:"1.2rem"},className:"d-block mb-3",children:e(d.Check,{type:"radio",id:"Stripe",label:"Stripe",value:"Stripe",checked:c==="Stripe",onChange:h=>l(h.target.value)})}),e(D,{className:"buttonsDefaultColors",type:"submit",children:"Continue"})]})]})]})]})}const Ue=(r,a)=>{switch(a.type){case"create_order_request":return y(f({},r),{loading:!0});case"create_order_success":return y(f({},r),{loading:!1});case"create_order_fail":return y(f({},r),{loading:!1});default:return r}};function Me(){const r=E(),[{loading:a},i]=g.exports.useReducer(Ue,{loading:!1}),{state:{cart:{shippingAddress:s,paymentMethod:n,cartItems:c},userInfo:l},dispatch:x,finishedShopping:h}=k();g.exports.useEffect(()=>{n||r("/payment")},[n,r]);const{itemsPrice:R,shippingPrice:C,taxPrice:_,totalPrice:o}=h(),v=async()=>{try{i({type:"create_order_request"});const{data:m}=await B.post("/api/orders",{orderItems:c,shippingAddress:s,paymentMethod:n,itemsPrice:R,shippingPrice:C,taxPrice:_,totalPrice:o},{headers:{authorization:`Bearer ${l.token}`}});x({type:"cart_clear"}),i({type:"create_order_success"}),localStorage.removeItem("cartItems"),r(`/order/${m.order.id}`)}catch(m){i({type:"create_order_fail"}),F.error(O(m))}};return t("div",{children:[e(W,{step1:!0,step2:!0,step3:!0,step4:!0}),e(T,{children:e("title",{children:"Preview Order"})}),e("h1",{className:"my-3",children:"Preview Order"}),t(L,{children:[t(u,{md:8,children:[e(I,{className:"mb-3",children:t(I.Body,{children:[e(I.Title,{children:"Shipping"}),t(I.Text,{children:[e("br",{}),e("strong",{children:"Name:"})," ",s==null?void 0:s.fullName,e("br",{}),e("strong",{children:"Address:"})," ",s==null?void 0:s.address,",",s==null?void 0:s.city,", ",s==null?void 0:s.postalCode,",",s==null?void 0:s.country]}),e(w,{to:"/shipping",children:"Edit"})]})}),e(I,{className:"mb-3",children:t(I.Body,{children:[e(I.Title,{children:"Payment"}),e(I.Text,{children:t("strong",{children:["Method: ",e("strong",{children:n})]})}),e(w,{to:"/payment",children:"Edit"})]})}),e(I,{className:"mb-3",children:t(I.Body,{children:[e(I.Title,{children:"Items"}),e(S,{variant:"flush",children:c.map(m=>e(S.Item,{children:t(L,{className:"align-items-center",children:[t(u,{md:6,children:[e("img",{src:m.image,alt:m.name,style:{height:"80px"},className:"img-fluid border border-dark p-1"})," ",e(w,{to:`/product/${m.slug}`,children:m.name})]}),e(u,{md:3,children:e("span",{children:m.quantity})}),e(u,{md:3,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m.price)})]})},m.id))}),e(w,{to:"/cart",children:"Edit"})]})})]}),e(u,{md:4,children:e(I,{children:t(I.Body,{children:[e(I.Title,{children:"Order Summary"}),t(S,{variant:"flush",children:[t(S.Item,{className:"d-flex mb-3",children:[e(u,{children:"Items"}),e(u,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(R)})]}),t(S.Item,{className:"d-flex mb-3",children:[e(u,{children:"Shipping"}),e(u,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(C)})]}),t(S.Item,{className:"d-flex mb-3",children:[e(u,{children:"Tax"}),e(u,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(_)})]}),t(S.Item,{className:"d-flex mb-3",children:[e(u,{children:e("strong",{children:"Order Total"})}),e(u,{children:e("strong",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o)})})]}),e(S.Item,{className:"",children:t("div",{className:"d-grid",children:[e(D,{className:"buttonsDefaultColors",type:"button",onClick:v,disabled:c.length===0,children:"Place Order"}),a&&e(U,{})]})})]})]})})})]})]})}const Ge=(r,a)=>{switch(a.type){case"fetch_request":return y(f({},r),{loading:!0,error:""});case"fetch_success":return y(f({},r),{loading:!1,order:a.order,error:""});case"fetch_fail":return y(f({},r),{loading:!1,error:a.error});case"pay_request":return y(f({},r),{loadingPay:!0});case"pay_success":return y(f({},r),{loadingPay:!1,successPay:!0});case"pay_fail":return y(f({},r),{loadingPay:!1});case"pay_reset":return y(f({},r),{loadingPay:!1,successPay:!1});default:return r}};function ze(){const{id:r}=ee(),a=E(),{state:{userInfo:i}}=k(),[{loading:s,order:n,error:c,successPay:l,loadingPay:x},h]=g.exports.useReducer(Ge,{loading:!0,order:{},error:"",loadingPay:!1,successPay:!1}),[{isPending:R},C]=ve();function _(m,p){return p.order.create({purchase_units:[{amount:{value:String(n.total_price)}}]}).then(N=>N)}function o(m,p){return p.order.capture().then(async function(N){try{h({type:"pay_request"});const{data:P}=await B.put(`/api/orders/${n.id}/pay`,N,{headers:{authorization:`Bearer ${i.token}`}});h({type:"pay_success"}),F.success("Order is paid")}catch(P){h({type:"pay_fail"}),F.error(O(P))}})}function v(m){F.error(O(m))}return g.exports.useEffect(()=>{if(!i)return a("/login");let m=new AbortController;const p=async()=>{try{h({type:"fetch_request"});const{data:N}=await B.get(`/api/orders/${r}`,{headers:{authorization:`Bearer ${i==null?void 0:i.token}`}});h({type:"fetch_success",order:N})}catch(N){h({type:"fetch_fail",error:O(N)})}};if(!n.id||l||n.id&&n.id!==r)return p(),l&&h({type:"pay_reset"}),()=>{m.abort()};(async()=>{const{data:P}=await B.get("/api/keys/paypal",{headers:{authorization:`Bearer ${i.token}`}});C({type:"resetOptions",value:{"client-id":P,currency:"BRL"}}),C({type:"setLoadingStatus",value:Ne.PENDING})})()},[n,i,l,r,a,C]),s?e(U,{}):c?e(A,{variant:"danger",children:c}):t("div",{children:[e(T,{children:e("title",{children:"Order"})}),e("h1",{className:"my-3",children:r}),t(L,{children:[t(u,{md:8,children:[e(I,{className:"mb-3",children:t(I.Body,{children:[e(I.Title,{children:"Shipping"}),t(I.Text,{children:[e("strong",{children:"Name: "})," ",n.shipping_address.fullName," ",e("br",{}),e("strong",{children:"Address: "})," ",n.shipping_address.address,",",n.shipping_address.city,","," ",n.shipping_address.postalCode,",",n.shipping_address.country]}),n.isDelivered?t(A,{variant:"success",children:["Delivered at ",n.deliveredAt]}):e(A,{variant:"danger",children:"Not Delivered"})]})}),e(I,{className:"mb-3",children:t(I.Body,{children:[e(I.Title,{children:"Payment"}),t(I.Text,{children:[e("strong",{children:"Method:"})," ",n.payment_method]}),n.is_paid?t(A,{variant:"success",children:["Paid at"," ",new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"long",year:"numeric"}).format(new Date(n.paid_at))]}):e(A,{variant:"danger",children:"Not Paid"})]})}),e(I,{className:"mb-3",children:t(I.Body,{children:[e(I.Title,{children:"Items"}),e(S,{variant:"flush",children:n.order_products.map(m=>(console.log("AQUI O EXEMPLO",n),e(S.Item,{children:t(L,{className:"align-items-center",children:[t(u,{md:6,children:[e("img",{src:m.image,alt:m.name,style:{height:"80px"},className:"img-fluid border border-dark p-1"})," ",e(w,{to:`/product/${m.slug}`,children:m.name})]}),e(u,{md:3,children:e("span",{children:m.quantity})}),e(u,{md:3,children:m.price})]})},m.id)))})]})})]}),e(u,{md:4,children:e(I,{className:"mb-3",children:t(I.Body,{children:[e(I.Title,{children:"Order Summary"}),t(S,{variant:"flush",children:[e(S.Item,{children:t(L,{children:[e(u,{children:"Items"}),e(u,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n.items_price)})]})}),e(S.Item,{children:t(L,{children:[e(u,{children:"Shipping"}),e(u,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n.shipping_price)})]})}),e(S.Item,{children:t(L,{children:[e(u,{children:"Tax"}),e(u,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n.tax_price)})]})}),e(S.Item,{children:t(L,{children:[e(u,{children:e("strong",{children:"Order Total"})}),e(u,{children:e("strong",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n.total_price)})})]})})]}),!n.is_paid&&t(S.Item,{children:[R?e(U,{}):e("div",{children:e(be,{createOrder:_,onApprove:o,onError:v})}),x&&e(U,{})]})]})})})]})]})}const je=(r,a)=>{switch(a.type){case"fetch_request":return y(f({},r),{loading:!0});case"fetch_success":return y(f({},r),{orders:a.orders,loading:!1});case"fetch_fail":return y(f({},r),{loading:!1,error:a.error});default:return r}};function Je(){const r=E(),{state:{userInfo:a}}=k(),[{loading:i,error:s,orders:n},c]=g.exports.useReducer(je,{loading:!0,error:"",orders:[]});return g.exports.useEffect(()=>{const l=new AbortController;return(async()=>{a||r("/signin");try{c({type:"fetch_request"});const{data:h}=await B.get("/api/orders/mine",{headers:{Authorization:`Bearer ${a.token}`}});c({type:"fetch_success",orders:h})}catch(h){c({type:"fetch_fail",error:O(h)})}})(),()=>{l.abort()}},[a,r]),t("div",{children:[e(T,{children:e("title",{children:"Order History"})}),e("h1",{children:"Order History"}),i?e(U,{}):s?e(A,{variant:"danger",children:s}):t("table",{className:"table",children:[e("thead",{children:t("tr",{children:[e("td",{children:"ID"}),e("td",{children:"DATE"}),e("td",{children:"TOTAL"}),e("td",{children:"PAID"}),e("td",{children:"DELIVERED"}),e("td",{children:"ACTIONS"})]})}),e("tbody",{children:n.map(l=>t("tr",{children:[e("td",{children:l.id}),e("td",{children:new Intl.DateTimeFormat("pt-BR",{dateStyle:"short"}).format(new Date(l.created_at))}),e("td",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l.total_price)}),e("td",{className:l.is_paid===!0?"paid":"notPaid",children:l.is_paid?new Intl.DateTimeFormat("pt-BR",{dateStyle:"short"}).format(new Date(l.created_at)):"No"}),e("td",{children:l.is_delivered?l.delivered_at.substring(0,10):"No"}),e("td",{children:e(D,{type:"button",className:"buttonsDefaultColors",onClick:()=>r(`/order/${l.id}`),children:"Details"})})]},l.id))})]})]})}const Qe=(r,a)=>{switch(a.type){case"update_request":return y(f({},r),{loadingUpdate:!0});case"update_success":return y(f({},r),{loadingUpdate:!1,updatedUser:a.updatedUser});case"update_fail":return y(f({},r),{loadingUpdate:!1});default:return r}};function Xe(){const r=E(),{state:a,dispatch:i}=k(),{userInfo:s}=a,[{loadingUpdate:n},c]=g.exports.useReducer(Qe,{loadingUpdate:!1,updatedUser:{}});s||r("/signin");const[l,x]=g.exports.useState(s.name),[h,R]=g.exports.useState(s.email),[C,_]=g.exports.useState(""),[o,v]=g.exports.useState("");return e("div",{className:"d-flex justify-content-center",children:t("div",{className:"w-50",children:[e(T,{children:e("title",{children:"User Profile"})}),e("h1",{children:"User Profile"}),t("form",{onSubmit:async p=>{p.preventDefault();try{const{data:N}=await B.put("/api/users/profile",{name:l,email:h,password:C},{headers:{Authorization:`Bearer ${s.token}`}});c({type:"update_success",updatedUser:N}),localStorage.setItem("userInfo",JSON.stringify(N)),F.success("User updated successfully")}catch(N){c({type:"update_fail"}),F.error(O(N))}},children:[t(d.Group,{className:"mb-3",controlId:"name",children:[e(d.Label,{children:"Name"}),e(d.Control,{value:l,onChange:p=>x(p.target.value),required:!0})]}),t(d.Group,{className:"mb-3",controlId:"email",children:[e(d.Label,{children:"Email"}),e(d.Control,{type:"email",value:h,onChange:p=>R(p.target.value),required:!0})]}),t(d.Group,{className:"mb-3",controlId:"password",children:[e(d.Label,{children:"Password"}),e(d.Control,{type:"password",value:C,onChange:p=>_(p.target.value),required:!0})]}),t(d.Group,{className:"mb-3",controlId:"confirmPassword",children:[e(d.Label,{children:"Confirm Password"}),e(d.Control,{type:"password",value:o,onChange:p=>v(p.target.value),required:!0})]}),e("div",{className:"mb-3",children:e(D,{type:"submit",className:"buttonsDefaultColors",children:"Update user data"})})]})]})})}const Ke=(r,a)=>{switch(a.type){case"fetch_request":return y(f({},r),{loading:!0});case"fetch_success":return y(f({},r),{products:a.products,page:a.page,pages:a.pages,countProducts:a.countProducts,loading:!1});case"fetch_fail":return y(f({},r),{error:a.error});default:return r}},Ve=[{name:"R$1 to R$50",value:"1-50"},{name:"R$51 to R$200",value:"51-200"},{name:"R$201 to R$1000",value:"201-1000"}],We=[{name:"4stars & up",rating:"4"},{name:"3stars & up",rating:"3"},{name:"2stars & up",rating:"2"},{name:"1stars & up",rating:"1"}];function Ye(){const r=E(),{search:a}=V(),i=new URLSearchParams(String(a)),s=i.get("category")||"all",n=i.get("query")||"all",c=i.get("price")||"all",l=i.get("rating")||"all",x=i.get("order")||"newest",h=i.get("page")||1,[R,C]=g.exports.useState([]),[{loading:_,error:o,products:v,pages:m,countProducts:p},N]=g.exports.useReducer(Ke,{loading:!0});g.exports.useEffect(()=>{const b=new AbortController;return(async()=>{try{const{data:q}=await B.get(`/api/products/search?page=${h}&query=${n}&category=${s}&price=${c}&rating=${l}&order=${x}`);N({type:"fetch_success",products:q.products,page:q.page,pages:q.pages,countProducts:q.countProducts})}catch(q){N({type:"fetch_fail",error:O(q)})}})(),()=>b.abort()},[s,o,x,h,c,n,l]),g.exports.useEffect(()=>{const b=new AbortController;return(async()=>{try{const{data:q}=await B.get("/api/products/categories");C(q)}catch(q){F.error(O(q))}})(),()=>b.abort()},[N]);const P=b=>{const Q=String(b.page||h),q=String(b.query||n),ne=String(b.category||s),se=String(b.price||c),ce=String(b.rating||l),ie=String(b.order||x);return`/search?page=${Q}&query=${q}&category=${ne}&price=${se}&rating=${ce}&order=${ie}`};return t("div",{children:[e(T,{children:e("title",{children:"Search PRoducts"})}),t(L,{children:[t(u,{md:3,children:[e("h3",{children:"Department"}),e("div",{children:t("ul",{children:[e(w,{className:s==="all"?"text-bold":"",to:P({category:"all"}),children:"Any"}),R.map(b=>e("li",{children:e(w,{className:s===b.category?"text-bold":"",to:P({category:b.category}),children:b.category})},b.category))]})}),t("div",{children:[e("h3",{children:"Price"}),t("ul",{children:[e("li",{children:e(w,{className:c==="all"?"text-bold":"",to:P({price:"all"}),children:"Any"})}),Ve.map(b=>e("li",{className:"my-1",children:e(w,{className:b.value===c?"text-bold":"",to:P({price:b.value}),children:b.name})},b.value))]})]}),t("div",{children:[e("h3",{children:"Avg. Customer Review"}),t("ul",{children:[We.map(b=>e("li",{children:e(w,{className:`${b.rating}`==`${l}`?"text-bold":"",to:P({rating:b.rating}),children:e(j,{caption:" & up",rating:Number(b.rating)})})},b.name)),e("li",{children:e(w,{to:P({rating:"all"}),className:l==="all"?"text-bold":"",children:e(j,{rating:0,caption:" & up"})})})]})]})]}),e(u,{md:9,children:_?e(U,{}):o?e(A,{variant:"danger",children:o}):t(J,{children:[t(L,{className:"justify-content-between mb-3",children:[e(u,{md:6,children:t("div",{children:[p===0?"No":p," Results",n!=="all"&&" : "+n,s!=="all"&&" : "+s,c!=="all"&&" : Price "+c,l!=="all"&&" : Rating "+l+" & up",n!=="all"||s!=="all"||l!=="all"||c!=="all"?e(D,{variant:"light",onClick:()=>r("/search"),children:e("i",{className:"fas fa-times-circle"})}):null]})}),t(u,{className:"text-end",children:["Sort by"," ",t("select",{value:x,onChange:b=>{r(P({order:b.target.value}))},children:[e("option",{value:"newest",children:"Newest Arrivals"}),e("option",{value:"lowest",children:"Price: Low to High"}),e("option",{value:"highest",children:"Price: High to Low"}),e("option",{value:"toprated",children:"Avg. Customer Reviews"})]})]})]}),v.length===0&&e(A,{children:"No Product Found"}),e(L,{children:v.map(b=>e(u,{sm:6,lg:4,className:"mb-3",children:e(ae,{product:b})},b.id))}),e("div",{children:[...Array(m).keys()].map(b=>e(M.Link,{as:w,className:"mx-1",to:P({page:String(b+1)}),children:e(D,{className:Number(h)===b+1?"text-bold buttonsDefaultCollors":"",children:b+1})},b+1))})]})})]})]})}function X({children:r}){const{state:{userInfo:a}}=k();return a?r:e(re,{to:"signin"})}function Ze(){return e("div",{children:"Dashboard"})}function er({children:r}){const{state:{userInfo:a}}=k();return a&&a.isAdmin?r:e(re,{to:"signin"})}function rr(){return t("div",{className:"d-flex flex-column site-container",children:[e(Be,{}),e("main",{style:{flex:1},children:e(G,{className:"mt-3",children:t(Ie,{children:[e($,{path:"/product/:slug",element:e(Ee,{})}),e($,{path:"/cart",element:e(qe,{})}),e($,{path:"/search",element:e(Ye,{})}),e($,{path:"/signin",element:e(Te,{})}),e($,{path:"/signup",element:e(Ae,{})}),e($,{path:"/shipping",element:e(Fe,{})}),e($,{path:"/payment",element:e(He,{})}),e($,{path:"/placeorder",element:e(Me,{})}),e($,{path:"/order/:id",element:e(X,{children:e(ze,{})})}),e($,{path:"/orderhistory",element:e(X,{children:e(Je,{})})}),e($,{path:"/profile",element:e(X,{children:e(Xe,{})})}),e($,{path:"/admin/dashboard",element:e(er,{children:e(Ze,{})})}),e($,{path:"/",element:e($e,{})})]})})}),e(Le,{})]})}Se.render(e(Ce.StrictMode,{children:e(Pe,{children:e(Re,{children:e(we,{children:e(xe,{options:{"client-id":"sb"},deferLoading:!0,children:e(rr,{})})})})})}),document.getElementById("root"));
