var Z=Object.defineProperty,ee=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var J=(r,a,l)=>a in r?Z(r,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[a]=l,p=(r,a)=>{for(var l in a||(a={}))te.call(a,l)&&J(r,l,a[l]);if(j)for(var l of j(a))ae.call(a,l)&&J(r,l,a[l]);return r},f=(r,a)=>ee(r,re(a));import{a as ne,r as N,u as O,j as e,b as t,F as A,T as se,N as U,C as H,c as X,L as w,B as G,d as M,e as g,f as B,S as ce,A as ie,W as q,R as L,g as h,h as b,i as K,k as Q,l as i,t as $,m as le,P as oe,n as de,o as ue,p as D,q as he,s as me,v as pe,w as fe,x as ge}from"./vendor.dfc021c4.js";const ye=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function l(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=l(s);fetch(s.href,c)}};ye();const R=ne.create({baseURL:"http://localhost:3333/api"}),V=N.exports.createContext({});function ve({children:r}){const a={userInfo:localStorage.getItem("userInfo")?JSON.parse(String(localStorage.getItem("userInfo"))):null,cart:{cartItems:localStorage.getItem("cartItems")?JSON.parse(String(localStorage.getItem("cartItems"))):[],shippingAddress:localStorage.getItem("shippingAddress")?JSON.parse(String(localStorage.getItem("shippingAddress"))):null,paymentMethod:localStorage.getItem("paymentMethod")?String(localStorage.getItem("paymentMethod")):""}},l=O(),[n,s]=N.exports.useReducer(c,a);function c(o,v){switch(v.type){case"cart_add_item":{const u=v.item,m=o.cart.cartItems.find(P=>P.id===u.id),I=m?o.cart.cartItems.map(P=>P.id===m.id?u:P):[...o.cart.cartItems,u];return localStorage.setItem("cartItems",JSON.stringify(I)),f(p({},o),{cart:f(p({},o.cart),{cartItems:I})})}case"cart_remove_item":{const u=o.cart.cartItems.filter(m=>m.id!==v.item.id);return localStorage.setItem("cartItems",JSON.stringify(u)),f(p({},o),{cart:f(p({},o.cart),{cartItems:u})})}case"cart_clear":return f(p({},o),{cart:f(p({},o.cart),{cartItems:[]})});case"user_signin":return f(p({},o),{userInfo:v.user});case"user_signout":return f(p({},o),{userInfo:null,cart:{cartItems:[],shippingAddress:{},paymentMethod:""}});case"save_shipping_address":return f(p({},o),{cart:f(p({},o.cart),{shippingAddress:v.shippingAddress})});case"save_payment_method":return f(p({},o),{cart:f(p({},o.cart),{paymentMethod:v.paymentMethod})});default:return o}}async function d(o,v){if((await R.get(`/products/${o.id}`)).data.countInStock<v){window.alert("Sorry, Product is out of stock");return}s({type:"cart_add_item",item:f(p({},o),{quantity:v})})}async function C(o){const v=n.cart.cartItems.find(P=>P.id===o.id),u=v?v.quantity+1:1;if((await R.get(`/products/${o.id}`)).data.countInStock<u){window.alert("Sorry, Product is out of stock");return}s({type:"cart_add_item",item:f(p({},o),{quantity:u})})}async function y(o){s({type:"cart_remove_item",item:o})}function x(){l("/signin?redirect=/shipping")}const S=()=>{s({type:"user_signout"}),localStorage.removeItem("userInfo"),localStorage.removeItem("shippingAddress"),localStorage.removeItem("paymentMethod"),window.location.href="/signin"};function _(){const o=P=>Math.round(P*100+Number.EPSILON)/100,v=o(n.cart.cartItems.reduce((P,Y)=>P+Y.price,0)),u=v>100?o(0):o(10),m=o(.15*v),I=v+u+m;return{itemsPrice:v,shippingPrice:u,taxPrice:m,totalPrice:I}}return e(V.Provider,{value:{state:n,finishedShopping:_,dispatch:s,updateCartHandler:d,removeProductHandler:y,checkoutHandler:x,addProductFromHomeScreenCartHandler:C,signOutHandler:S},children:r})}function k(){return N.exports.useContext(V)}function Ne(){return e("footer",{className:"text-center",children:e("div",{children:"All rights reserved"})})}function Ie(){const{state:r,signOutHandler:a}=k(),{cart:l,userInfo:n}=r;return t(A,{children:[e(se,{position:"bottom-center",limit:1}),e("header",{children:e(U,{bg:"dark",variant:"dark",expand:"lg",children:t(H,{children:[e(X.Link,{as:w,to:"/",children:e(U.Brand,{children:"amazona"})}),e(U.Toggle,{"aria-controls":"basic-navbar-nav"}),e(U.Collapse,{id:"basic-navbar-nav",children:t(X,{className:"me-auto w-100 justify-content-end",children:[t(w,{to:"/cart",className:"nav-link",children:["Cart",l.cartItems.length>0&&e(G,{pill:!0,bg:"danger",children:l.cartItems.reduce((s,c)=>s+c.quantity,0)})]}),n?t(M,{title:n.name,id:"basic-nav-dropdown",children:[e(M.Item,{as:w,to:"/profile",children:"User Profile"}),e(M.Item,{as:w,to:"/orderhistory",children:"Order History"}),e(M.Divider,{}),e(w,{to:"#signout",className:"dropdown-item",onClick:a,children:"Sign Out"})]}):e(w,{className:"nav-link",to:"/signin",children:"Sign In"})]})})]})})})]})}const be="_rating_qtjti_1";var Se={rating:be};function W({rating:r,numReviews:a}){return t("div",{className:Se.rating,children:[e("span",{children:e("i",{className:r>=1?"fas fa-star":r>=.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=2?"fas fa-star":r>=1.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=3?"fas fa-star":r>=2.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=4?"fas fa-star":r>=3.5?"fa fa-star-half-alt":"far fa-star"})}),e("span",{children:e("i",{className:r>=5?"fas fa-star":r>=4.5?"fa fa-star-half-alt":"far fa-star"})}),t("span",{children:["\xA0\xA0",a," reviews"]})]})}function _e({product:r}){const{addProductFromHomeScreenCartHandler:a}=k();return t(g,{className:"productItem",children:[e(w,{to:`/product/${r.slug}`,children:e("img",{src:r.image,className:"card-img-top",alt:r.name})}),t(g.Body,{children:[e(w,{to:`/product/${r.slug}`,children:e(g.Title,{color:"secondary",children:r.name})}),e(W,{rating:r.rating,numReviews:r.numReviews}),e(g.Text,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r.price)}),r.countInStock===0?e(B,{variant:"secondary",disabled:!0,children:"Out of Stock"}):e(B,{className:"buttonsDefaultColors",onClick:()=>a(r),children:"Add to Cart"})]})]})}function F(){return e(ce,{animation:"border",role:"status",children:e("span",{className:"visually-hidden",children:"Carregando..."})})}function T({variant:r,children:a}){return e(ie,{variant:r||"info",children:a})}function Pe(r,a){switch(a.type){case"request":return f(p({},r),{isLoading:!0});case"success":return f(p({},r),{products:a.products,isLoading:!1});case"fail":return f(p({},r),{isLoading:!1,error:a.error});default:return r}}function Ce(){const[{products:r,isLoading:a,error:l},n]=N.exports.useReducer(Pe,{products:[],isLoading:!1,error:""});return N.exports.useEffect(()=>{(async()=>{n({type:"request"});try{const c=await R.get("/products");n({type:"success",products:c.data})}catch(c){n({type:"fail",error:c.message})}})()},[]),t("div",{className:"container",children:[e(q,{children:e("title",{children:"Amazona"})}),e("h1",{children:"Featured products"}),e("div",{className:"products",children:a?e(F,{}):l?e(T,{variant:"danger",children:l}):e(L,{children:r.map(s=>e(h,{sm:6,md:4,lg:3,className:"mb-3",children:e(_e,{product:s})},s.slug))})})]})}function we(){const{state:r,updateCartHandler:a,removeProductHandler:l,checkoutHandler:n}=k(),{cart:{cartItems:s}}=r;return t("div",{children:[e(q,{children:e("title",{children:"Shopping Cart"})}),e("h1",{children:"Shopping Cart"}),t(L,{children:[e(h,{md:8,children:s.length===0?t(T,{children:["Cart is empty. ",e(w,{to:"/",children:"Go Shopping"})]}):e(b,{children:s.map(c=>e(b.Item,{children:t(L,{className:"align-items-center",children:[t(h,{md:"4",className:"d-flex align-items-center justify-content-around",children:[e("img",{src:c.image,alt:c.name,style:{height:"80px"},className:"img-fluid border border-dark p-1"})," ",e(w,{to:`/product/${c.slug}`,children:c.name})]}),t(h,{md:"3",children:[e(B,{variant:"light",onClick:()=>a(c,c.quantity-1),disabled:c.quantity===1,children:e("i",{className:"fas fa-minus-circle"})})," ",e("span",{children:c.quantity})," ",e(B,{variant:"light",onClick:()=>a(c,c.quantity+1),disabled:c.quantity===c.countInStock,children:e("i",{className:"fas fa-plus-circle"})})]}),e(h,{md:"3",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c.price)}),e(h,{md:"2",children:e(B,{variant:"light",children:e("i",{className:"fas fa-trash",onClick:()=>l(c)})})})]})},c.id))})}),e(h,{md:4,children:e(g,{children:e(g.Body,{children:t(b,{variant:"flush",children:[e(b.Item,{children:t("h3",{children:["Subtotal (",s.reduce((c,d)=>c+d.quantity,0)," ","items):",e("br",{}),e("br",{}),new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.reduce((c,d)=>c+d.price*d.quantity,0))]})}),e(b.Item,{children:e("div",{className:"d-grid",children:e(B,{className:"buttonsDefaultColors",type:"button",onClick:n,disabled:s.length===0,children:"Proceed to Checkout"})})})]})})})})]})]})}const E=r=>r.response&&r.response.data.message?r.response.data.message:r.message;function xe(r,a){switch(a.type){case"request":return f(p({},r),{isLoading:!0});case"success":return f(p({},r),{product:a.product,isLoading:!1});case"fail":return f(p({},r),{isLoading:!1,error:a.error});default:return r}}function Le(){const r=O(),[{product:a,isLoading:l,error:n},s]=N.exports.useReducer(xe,{product:{},isLoading:!1,error:""}),{slug:c}=K();N.exports.useEffect(()=>{(async()=>{s({type:"request"});try{const _=await R.get(`/products/slug/${c}`);s({type:"success",product:_.data})}catch(_){s({type:"fail",error:E(_)})}})()},[c]);const{state:d,dispatch:C}=k(),{cart:y}=d;async function x(){const S=y.cartItems.find(v=>v.id===a.id),_=S?S.quantity+1:1,{data:o}=await R.get(`/products/${a.id}`);if(o.countInStock<_){window.alert("Sorry. Product is out of stock");return}C({type:"cart_add_item",item:f(p({},a),{quantity:_})}),r("/cart")}return e(A,{children:l?e(F,{}):n?e(T,{variant:"danger",children:n}):t(L,{children:[e(h,{md:6,children:e("img",{className:"imgLarge",src:a.image,alt:a.name})}),e(h,{md:3,children:t(b,{variant:"flush",children:[t(b.Item,{className:"my-3",children:[e(q,{children:e("title",{children:a.name})}),e("h1",{children:a.name})]}),e(b.Item,{children:e(W,{rating:a.rating,numReviews:a.numReviews})}),t(b.Item,{children:["Price :",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.price)]}),t(b.Item,{children:["Description:",e("p",{children:a.description})]})]})}),e(h,{md:3,children:e(g,{children:e(g.Body,{children:t(b,{variant:"flush",children:[e(b.Item,{children:t(L,{children:[e(h,{children:"Price:"}),e(h,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a.price)})]})}),e(b.Item,{children:t(L,{children:[e(h,{children:"Status:"}),e(h,{children:a.countInStock>0?e(G,{bg:"success",children:"In Stock"}):e(G,{bg:"danger",children:"Unavailable"})})]})}),a.countInStock>0&&e(b.Item,{children:e("div",{className:"d-grid",children:e(B,{style:{backgroundColor:"#ffc000",color:"#000"},variant:"primary",onClick:x,children:"Add to Cart"})})})]})})})})]})})}function Be(){const r=O(),{search:a}=Q(),l=new URLSearchParams(a).get("redirect"),n=l||"/",[s,c]=N.exports.useState(),[d,C]=N.exports.useState(),{state:y,dispatch:x}=k(),{userInfo:S}=y;async function _(o){o.preventDefault();try{const{data:v}=await R.post("/users/signin",{email:s,password:d});x({type:"user_signin",user:v}),localStorage.setItem("userInfo",JSON.stringify(v)),r(n||"/")}catch(v){$.error(E(v))}}return N.exports.useEffect(()=>{S&&r(n)},[r,n,S]),t(H,{className:"smallContainer",children:[e(q,{children:e("title",{children:"Sign In"})}),e("h1",{className:"my-3",children:"Sign In"}),t(i,{onSubmit:_,children:[t(i.Group,{className:"mb-3",controlId:"email",children:[e(i.Label,{children:"Email"}),e(i.Control,{type:"email",onChange:o=>c(o.target.value),required:!0})]}),t(i.Group,{className:"mb-3",controlId:"password",children:[e(i.Label,{children:"Password"}),e(i.Control,{type:"password",onChange:o=>C(o.target.value),required:!0})]}),e("div",{className:"mb-3",children:e(B,{className:"buttonsDefaultColors",type:"submit",children:"Sign In"})}),t("div",{children:["New customer?"," ",e(w,{to:`/signup?redirect=${n}`,children:"Create your account"})]})]})]})}function Re(){const r=O(),{search:a}=Q(),l=new URLSearchParams(a).get("redirect"),n=l||"/",[s,c]=N.exports.useState(),[d,C]=N.exports.useState(),[y,x]=N.exports.useState(),[S,_]=N.exports.useState(),{state:o,dispatch:v}=k(),{userInfo:u}=o;async function m(I){if(I.preventDefault(),y!==S){$.error("Passwords do not match");return}try{const{data:P}=await R.post("/users/signup",{name:s,email:d,password:y});v({type:"user_signin",user:P}),localStorage.setItem("userInfo",JSON.stringify(P)),r(n||"/")}catch(P){$.error(E(P))}}return N.exports.useEffect(()=>{u&&r(n)},[r,n,u]),t(H,{className:"smallContainer",children:[e(q,{children:e("title",{children:"Sign Up"})}),e("h1",{className:"my-3",children:"Sign Up"}),t(i,{onSubmit:m,children:[t(i.Group,{children:[e(i.Label,{children:"Name"}),e(i.Control,{onChange:I=>c(I.target.value),required:!0})]}),t(i.Group,{className:"mb-3",controlId:"email",children:[e(i.Label,{children:"Email"}),e(i.Control,{type:"email",onChange:I=>C(I.target.value),required:!0})]}),t(i.Group,{className:"mb-3",controlId:"password",children:[e(i.Label,{children:"Password"}),e(i.Control,{type:"password",onChange:I=>x(I.target.value),required:!0})]}),t(i.Group,{className:"mb-3",controlId:"confirmPassword",children:[e(i.Label,{children:"Confirm Password"}),e(i.Control,{type:"password",onChange:I=>_(I.target.value),required:!0})]}),e("div",{className:"mb-3",children:e(B,{className:"buttonsDefaultColors",type:"submit",children:"Sign Up"})}),t("div",{children:["Already have an account?"," ",e(w,{to:`/signin?redirect=${n}`,children:"Sign-In"})]})]})]})}function z({step1:r,step2:a,step3:l,step4:n}){return t(L,{className:"checkoutSteps",children:[e(h,{className:r?"active":"",children:"Sign-In"}),e(h,{className:a?"active":"",children:"Shipping"}),e(h,{className:l?"active":"",children:"Payment"}),e(h,{className:n?"active":"",children:"Place Order"})]})}function ke(){const r=O(),{state:a,dispatch:l}=k(),{shippingAddress:n}=a.cart,[s,c]=N.exports.useState((n==null?void 0:n.fullName)||""),[d,C]=N.exports.useState((n==null?void 0:n.address)||""),[y,x]=N.exports.useState((n==null?void 0:n.city)||""),[S,_]=N.exports.useState((n==null?void 0:n.postalCode)||""),[o,v]=N.exports.useState((n==null?void 0:n.country)||"");return N.exports.useEffect(()=>{a.userInfo||r("/signin?redirect=/shipping")},[a.userInfo,r]),t(A,{children:[e(z,{step1:!0,step2:!0}),t("div",{className:"d-flex justify-content-center",children:[e(q,{children:e("title",{children:"Shipping Address"})}),t("div",{className:"w-50",children:[e("h1",{className:"my-3",children:"Shipping Address"}),t(i,{onSubmit:m=>{m.preventDefault();const I={fullName:s,address:d,city:y,postalCode:S,country:o};l({type:"save_shipping_address",shippingAddress:I}),localStorage.setItem("shippingAddress",JSON.stringify(I)),r("/payment")},children:[t(i.Group,{className:"mb-3",children:[e(i.Label,{children:"Full Name"}),e(i.Control,{value:s,onChange:m=>c(m.target.value),required:!0})]}),t(i.Group,{className:"mb-3",children:[e(i.Label,{children:"Address"}),e(i.Control,{value:d,onChange:m=>C(m.target.value),required:!0})]}),t(i.Group,{className:"mb-3",children:[e(i.Label,{children:"City"}),e(i.Control,{value:y,onChange:m=>x(m.target.value),required:!0})]}),t(i.Group,{className:"mb-3",children:[e(i.Label,{children:"Postal Code"}),e(i.Control,{value:S,onChange:m=>_(m.target.value),required:!0})]}),t(i.Group,{className:"mb-3",children:[e(i.Label,{children:"Country"}),e(i.Control,{value:o,onChange:m=>v(m.target.value),required:!0})]}),e(i.Group,{className:"mb-3",children:e(B,{className:"buttonsDefaultColors",type:"submit",children:"Continue"})})]})]})]})]})}function De(){const r=O(),{state:a,dispatch:l}=k(),{cart:{shippingAddress:n,paymentMethod:s}}=a,[c,d]=N.exports.useState(s||"PayPal"),C=y=>{y.preventDefault(),l({type:"save_payment_method",paymentMethod:c}),localStorage.setItem("paymentMethod",c),r("/placeorder")};return N.exports.useEffect(()=>{(n==null?void 0:n.address)||r("/shipping")},[n,r]),t(A,{children:[e(z,{step1:!0,step2:!0,step3:!0}),t("div",{children:[e(q,{children:e("title",{children:"Payment Method"})}),t(H,{className:"w-50 text-left",children:[e("h1",{className:"my-3",children:"Payment Method"}),t(i,{onSubmit:C,children:[e("div",{style:{fontSize:"1.2rem"},className:"d-block mb-3",children:e(i.Check,{type:"radio",id:"PayPal",label:"PayPal",value:"PayPal",checked:c==="PayPal",onChange:y=>d(y.target.value)})}),e("div",{style:{fontSize:"1.2rem"},className:"d-block mb-3",children:e(i.Check,{type:"radio",id:"Stripe",label:"Stripe",value:"Stripe",checked:c==="Stripe",onChange:y=>d(y.target.value)})}),e(B,{className:"buttonsDefaultColors",type:"submit",children:"Continue"})]})]})]})]})}const qe=(r,a)=>{switch(a.type){case"create_order_request":return f(p({},r),{loading:!0});case"create_order_success":return f(p({},r),{loading:!1});case"create_order_fail":return f(p({},r),{loading:!1});default:return r}};function Oe(){const r=O(),[{loading:a},l]=N.exports.useReducer(qe,{loading:!1}),{state:{cart:{shippingAddress:n,paymentMethod:s,cartItems:c},userInfo:d},dispatch:C,finishedShopping:y}=k();N.exports.useEffect(()=>{s||r("/payment")},[s,r]);const{itemsPrice:x,shippingPrice:S,taxPrice:_,totalPrice:o}=y(),v=async()=>{try{l({type:"create_order_request"});const{data:u}=await R.post("/orders",{orderItems:c,shippingAddress:n,paymentMethod:s,itemsPrice:x,shippingPrice:S,taxPrice:_,totalPrice:o},{headers:{authorization:`Bearer ${d.token}`}});C({type:"cart_clear"}),l({type:"create_order_success"}),localStorage.removeItem("cartItems"),r(`/order/${u.order.id}`)}catch(u){l({type:"create_order_fail"}),$.error(E(u))}};return t("div",{children:[e(z,{step1:!0,step2:!0,step3:!0,step4:!0}),e(q,{children:e("title",{children:"Preview Order"})}),e("h1",{className:"my-3",children:"Preview Order"}),t(L,{children:[t(h,{md:8,children:[e(g,{className:"mb-3",children:t(g.Body,{children:[e(g.Title,{children:"Shipping"}),t(g.Text,{children:[e("br",{}),e("strong",{children:"Name:"})," ",n==null?void 0:n.fullName,e("br",{}),e("strong",{children:"Address:"})," ",n==null?void 0:n.address,",",n==null?void 0:n.city,", ",n==null?void 0:n.postalCode,",",n==null?void 0:n.country]}),e(w,{to:"/shipping",children:"Edit"})]})}),e(g,{className:"mb-3",children:t(g.Body,{children:[e(g.Title,{children:"Payment"}),e(g.Text,{children:t("strong",{children:["Method: ",e("strong",{children:s})]})}),e(w,{to:"/payment",children:"Edit"})]})}),e(g,{className:"mb-3",children:t(g.Body,{children:[e(g.Title,{children:"Items"}),e(b,{variant:"flush",children:c.map(u=>e(b.Item,{children:t(L,{className:"align-items-center",children:[t(h,{md:6,children:[e("img",{src:u.image,alt:u.name,style:{height:"80px"},className:"img-fluid border border-dark p-1"})," ",e(w,{to:`/product/${u.slug}`,children:u.name})]}),e(h,{md:3,children:e("span",{children:u.quantity})}),e(h,{md:3,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(u.price)})]})},u.id))}),e(w,{to:"/cart",children:"Edit"})]})})]}),e(h,{md:4,children:e(g,{children:t(g.Body,{children:[e(g.Title,{children:"Order Summary"}),t(b,{variant:"flush",children:[t(b.Item,{className:"d-flex mb-3",children:[e(h,{children:"Items"}),e(h,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x)})]}),t(b.Item,{className:"d-flex mb-3",children:[e(h,{children:"Shipping"}),e(h,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(S)})]}),t(b.Item,{className:"d-flex mb-3",children:[e(h,{children:"Tax"}),e(h,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(_)})]}),t(b.Item,{className:"d-flex mb-3",children:[e(h,{children:e("strong",{children:"Order Total"})}),e(h,{children:e("strong",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o)})})]}),e(b.Item,{className:"",children:t("div",{className:"d-grid",children:[e(B,{className:"buttonsDefaultColors",type:"button",onClick:v,disabled:c.length===0,children:"Place Order"}),a&&e(F,{})]})})]})]})})})]})]})}const Te=(r,a)=>{switch(a.type){case"fetch_request":return f(p({},r),{loading:!0,error:""});case"fetch_success":return f(p({},r),{loading:!1,order:a.order,error:""});case"fetch_fail":return f(p({},r),{loading:!1,error:a.error});case"pay_request":return f(p({},r),{loadingPay:!0});case"pay_success":return f(p({},r),{loadingPay:!1,successPay:!0});case"pay_fail":return f(p({},r),{loadingPay:!1});case"pay_reset":return f(p({},r),{loadingPay:!1,successPay:!1});default:return r}};function $e(){const{id:r}=K(),a=O(),{state:{userInfo:l}}=k(),[{loading:n,order:s,error:c,successPay:d,loadingPay:C},y]=N.exports.useReducer(Te,{loading:!0,order:{},error:"",loadingPay:!1,successPay:!1}),[{isPending:x},S]=le();function _(u,m){return m.order.create({purchase_units:[{amount:{value:String(s.total_price)}}]}).then(I=>I)}function o(u,m){return m.order.capture().then(async function(I){try{y({type:"pay_request"});const{data:P}=await R.put(`/orders/${s.id}/pay`,I,{headers:{authorization:`Bearer ${l.token}`}});y({type:"pay_success"}),$.success("Order is paid")}catch(P){y({type:"pay_fail"}),$.error(E(P))}})}function v(u){$.error(E(u))}return N.exports.useEffect(()=>{if(!l)return a("/login");let u=new AbortController;const m=async()=>{try{y({type:"fetch_request"});const{data:I}=await R.get(`/orders/${r}`,{headers:{authorization:`Bearer ${l==null?void 0:l.token}`}});y({type:"fetch_success",order:I})}catch(I){y({type:"fetch_fail",error:E(I)})}};if(!s.id||d||s.id&&s.id!==r)return m(),d&&y({type:"pay_reset"}),()=>{u.abort()};(async()=>{const{data:P}=await R.get("/keys/paypal",{headers:{authorization:`Bearer ${l.token}`}});S({type:"resetOptions",value:{"client-id":P,currency:"BRL"}}),S({type:"setLoadingStatus",value:de.PENDING})})()},[s,l,d,r,a,S]),n?e(F,{}):c?e(T,{variant:"danger",children:c}):t("div",{children:[e(q,{children:e("title",{children:"Order"})}),e("h1",{className:"my-3",children:r}),t(L,{children:[t(h,{md:8,children:[e(g,{className:"mb-3",children:t(g.Body,{children:[e(g.Title,{children:"Shipping"}),t(g.Text,{children:[e("strong",{children:"Name: "})," ",s.shipping_address.fullName," ",e("br",{}),e("strong",{children:"Address: "})," ",s.shipping_address.address,",",s.shipping_address.city,","," ",s.shipping_address.postalCode,",",s.shipping_address.country]}),s.isDelivered?t(T,{variant:"success",children:["Delivered at ",s.deliveredAt]}):e(T,{variant:"danger",children:"Not Delivered"})]})}),e(g,{className:"mb-3",children:t(g.Body,{children:[e(g.Title,{children:"Payment"}),t(g.Text,{children:[e("strong",{children:"Method:"})," ",s.payment_method]}),s.is_paid?t(T,{variant:"success",children:["Paid at"," ",new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"long",year:"numeric"}).format(new Date(s.paid_at))]}):e(T,{variant:"danger",children:"Not Paid"})]})}),e(g,{className:"mb-3",children:t(g.Body,{children:[e(g.Title,{children:"Items"}),e(b,{variant:"flush",children:s.order_products.map(u=>(console.log("AQUI O EXEMPLO",s),e(b.Item,{children:t(L,{className:"align-items-center",children:[t(h,{md:6,children:[e("img",{src:u.image,alt:u.name,style:{height:"80px"},className:"img-fluid border border-dark p-1"})," ",e(w,{to:`/product/${u.slug}`,children:u.name})]}),e(h,{md:3,children:e("span",{children:u.quantity})}),e(h,{md:3,children:u.price})]})},u.id)))})]})})]}),e(h,{md:4,children:e(g,{className:"mb-3",children:t(g.Body,{children:[e(g.Title,{children:"Order Summary"}),t(b,{variant:"flush",children:[e(b.Item,{children:t(L,{children:[e(h,{children:"Items"}),e(h,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.items_price)})]})}),e(b.Item,{children:t(L,{children:[e(h,{children:"Shipping"}),e(h,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.shipping_price)})]})}),e(b.Item,{children:t(L,{children:[e(h,{children:"Tax"}),e(h,{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.tax_price)})]})}),e(b.Item,{children:t(L,{children:[e(h,{children:e("strong",{children:"Order Total"})}),e(h,{children:e("strong",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.total_price)})})]})})]}),!s.is_paid&&t(b.Item,{children:[x?e(F,{}):e("div",{children:e(oe,{createOrder:_,onApprove:o,onError:v})}),C&&e(F,{})]})]})})})]})]})}const Ee=(r,a)=>{switch(a.type){case"fetch_request":return f(p({},r),{loading:!0});case"fetch_success":return f(p({},r),{orders:a.orders,loading:!1});case"fetch_fail":return f(p({},r),{loading:!1,error:a.error});default:return r}};function Fe(){const r=O(),{state:{userInfo:a}}=k(),[{loading:l,error:n,orders:s},c]=N.exports.useReducer(Ee,{loading:!0,error:"",orders:[]});return N.exports.useEffect(()=>{const d=new AbortController;return(async()=>{a||r("/signin");try{c({type:"fetch_request"});const{data:y}=await R.get("/orders/mine",{headers:{Authorization:`Bearer ${a.token}`}});c({type:"fetch_success",orders:y})}catch(y){c({type:"fetch_fail",error:E(y)})}})(),()=>{d.abort()}},[a,r]),t("div",{children:[e(q,{children:e("title",{children:"Order History"})}),e("h1",{children:"Order History"}),l?e(F,{}):n?e(T,{variant:"danger",children:n}):t("table",{className:"table",children:[e("thead",{children:t("tr",{children:[e("td",{children:"ID"}),e("td",{children:"DATE"}),e("td",{children:"TOTAL"}),e("td",{children:"PAID"}),e("td",{children:"DELIVERED"}),e("td",{children:"ACTIONS"})]})}),e("tbody",{children:s.map(d=>t("tr",{children:[e("td",{children:d.id}),e("td",{children:new Intl.DateTimeFormat("pt-BR",{dateStyle:"short"}).format(new Date(d.created_at))}),e("td",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(d.total_price)}),e("td",{className:d.is_paid===!0?"paid":"notPaid",children:d.is_paid?new Intl.DateTimeFormat("pt-BR",{dateStyle:"short"}).format(new Date(d.created_at)):"No"}),e("td",{children:d.is_delivered?d.delivered_at.substring(0,10):"No"}),e("td",{children:e(B,{type:"button",className:"buttonsDefaultColors",onClick:()=>r(`/order/${d.id}`),children:"Details"})})]},d.id))})]})]})}const He=(r,a)=>{switch(a.type){case"update_request":return f(p({},r),{loadingUpdate:!0});case"update_success":return f(p({},r),{loadingUpdate:!1,updatedUser:a.updatedUser});case"update_fail":return f(p({},r),{loadingUpdate:!1});default:return r}};function Ue(){const r=O(),{state:a,dispatch:l}=k(),{userInfo:n}=a,[{loadingUpdate:s},c]=N.exports.useReducer(He,{loadingUpdate:!1,updatedUser:{}});n||r("/signin");const[d,C]=N.exports.useState(n.name),[y,x]=N.exports.useState(n.email),[S,_]=N.exports.useState(""),[o,v]=N.exports.useState("");return e("div",{className:"d-flex justify-content-center",children:t("div",{className:"w-50",children:[e(q,{children:e("title",{children:"User Profile"})}),e("h1",{children:"User Profile"}),t("form",{onSubmit:async m=>{m.preventDefault();try{const{data:I}=await R.put("/users/profile",{name:d,email:y,password:S},{headers:{Authorization:`Bearer ${n.token}`}});c({type:"update_success",updatedUser:I}),localStorage.setItem("userInfo",JSON.stringify(I)),$.success("User updated successfully")}catch(I){c({type:"update_fail"}),$.error(E(I))}},children:[t(i.Group,{className:"mb-3",controlId:"name",children:[e(i.Label,{children:"Name"}),e(i.Control,{value:d,onChange:m=>C(m.target.value),required:!0})]}),t(i.Group,{className:"mb-3",controlId:"email",children:[e(i.Label,{children:"Email"}),e(i.Control,{type:"email",value:y,onChange:m=>x(m.target.value),required:!0})]}),t(i.Group,{className:"mb-3",controlId:"password",children:[e(i.Label,{children:"Password"}),e(i.Control,{type:"password",value:S,onChange:m=>_(m.target.value),required:!0})]}),t(i.Group,{className:"mb-3",controlId:"confirmPassword",children:[e(i.Label,{children:"Confirm Password"}),e(i.Control,{type:"password",value:o,onChange:m=>v(m.target.value),required:!0})]}),e("div",{className:"mb-3",children:e(B,{type:"submit",className:"buttonsDefaultColors",children:"Update user data"})})]})]})})}function Me(){return t("div",{className:"d-flex flex-column site-container",children:[e(Ie,{}),e("main",{style:{flex:1},children:e(H,{className:"mt-3",children:t(ue,{children:[e(D,{path:"/",element:e(Ce,{})}),e(D,{path:"/product/:slug",element:e(Le,{})}),e(D,{path:"/cart",element:e(we,{})}),e(D,{path:"/signin",element:e(Be,{})}),e(D,{path:"/signup",element:e(Re,{})}),e(D,{path:"/shipping",element:e(ke,{})}),e(D,{path:"/payment",element:e(De,{})}),e(D,{path:"/placeorder",element:e(Oe,{})}),e(D,{path:"/order/:id",element:e($e,{})}),e(D,{path:"/orderhistory",element:e(Fe,{})}),e(D,{path:"/profile",element:e(Ue,{})})]})})}),e(Ne,{})]})}he.render(e(me.StrictMode,{children:e(pe,{children:e(ve,{children:e(fe,{children:e(ge,{options:{"client-id":"sb"},deferLoading:!0,children:e(Me,{})})})})})}),document.getElementById("root"));
